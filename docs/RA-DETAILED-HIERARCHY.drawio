<mxfile host="app.diagrams.net" modified="2026-01-16T12:00:00.000Z" agent="Claude Code" version="24.0.0">
  <diagram name="High-Level User Hierarchy" id="high-level-hierarchy">
    <mxGraphModel dx="1800" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="main-title" value="Registration Authority (RA) - Complete User Hierarchy &amp; Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="200" y="40" width="1200" height="50" as="geometry" />
        </mxCell>

        <mxCell id="subtitle" value="MVP Requirements - Complete Certificate Lifecycle Management" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="200" y="90" width="1200" height="30" as="geometry" />
        </mxCell>

        <!-- Active Directory Box -->
        <mxCell id="ad-system" value="ACTIVE DIRECTORY (AD)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=18;fontStyle=1;verticalAlign=top;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="400" y="160" width="800" height="140" as="geometry" />
        </mxCell>

        <mxCell id="ad-content" value="Authentication Source&#xa;LDAP/LDAPS: ldap://ad.company.com:389&#xa;Base DN: dc=company,dc=com&#xa;&#xa;User Attributes: displayName, mail, department, memberOf&#xa;Group Memberships â†’ Role Mapping" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="420" y="195" width="760" height="95" as="geometry" />
        </mxCell>

        <!-- Arrow from AD to Role Mapping -->
        <mxCell id="arrow-ad-roles" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;fontSize=14;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ad-system" target="role-mapping-box">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="300" as="sourcePoint" />
            <mxPoint x="800" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-ad-label" value="Authentication &amp; Group Membership Validation" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;fontStyle=1;fontColor=#1a1a1a;" vertex="1" connectable="0" parent="arrow-ad-roles">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Role Mapping Box -->
        <mxCell id="role-mapping-box" value="AD GROUP â†’ APPLICATION ROLE MAPPING" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=18;fontStyle=1;verticalAlign=top;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="300" y="360" width="1000" height="180" as="geometry" />
        </mxCell>

        <!-- Mapping Table -->
        <mxCell id="mapping-table" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="340" y="400" width="920" height="125" as="geometry" />
        </mxCell>

        <!-- Row 1 -->
        <mxCell id="map-row1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" vertex="1" parent="mapping-table">
          <mxGeometry width="920" height="25" as="geometry" />
        </mxCell>
        <mxCell id="map-r1c1" value="&quot;PKI-RA-Admins&quot;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#f8cecc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row1">
          <mxGeometry width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="map-r1c2" value="â†’  RA Administrator" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#f8cecc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row1">
          <mxGeometry x="460" width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>

        <!-- Row 2 -->
        <mxCell id="map-row2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" vertex="1" parent="mapping-table">
          <mxGeometry y="25" width="920" height="25" as="geometry" />
        </mxCell>
        <mxCell id="map-r2c1" value="&quot;PKI-RA-Officers&quot;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#ffe6cc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row2">
          <mxGeometry width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="map-r2c2" value="â†’  RA Officer" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#ffe6cc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row2">
          <mxGeometry x="460" width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>

        <!-- Row 3 -->
        <mxCell id="map-row3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" vertex="1" parent="mapping-table">
          <mxGeometry y="50" width="920" height="25" as="geometry" />
        </mxCell>
        <mxCell id="map-r3c1" value="&quot;PKI-RA-Operators&quot;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row3">
          <mxGeometry width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="map-r3c2" value="â†’  RA Operator" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#d5e8d4;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row3">
          <mxGeometry x="460" width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>

        <!-- Row 4 -->
        <mxCell id="map-row4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" vertex="1" parent="mapping-table">
          <mxGeometry y="75" width="920" height="25" as="geometry" />
        </mxCell>
        <mxCell id="map-r4c1" value="&quot;PKI-Auditors&quot;" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#e1d5e7;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row4">
          <mxGeometry width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="map-r4c2" value="â†’  Auditor" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#e1d5e7;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row4">
          <mxGeometry x="460" width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>

        <!-- Row 5 -->
        <mxCell id="map-row5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" vertex="1" parent="mapping-table">
          <mxGeometry y="100" width="920" height="25" as="geometry" />
        </mxCell>
        <mxCell id="map-r5c1" value="&quot;Domain Users&quot; (default)" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row5">
          <mxGeometry width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="map-r5c2" value="â†’  End Entity" style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;fillColor=#dae8fc;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=13;fontStyle=1;" vertex="1" parent="map-row5">
          <mxGeometry x="460" width="460" height="25" as="geometry">
            <mxRectangle width="460" height="25" as="alternateBounds" />
          </mxGeometry>
        </mxCell>

        <!-- Arrow to Hierarchy -->
        <mxCell id="arrow-roles-hierarchy" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3;fontSize=14;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="role-mapping-box" target="hierarchy-label">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="540" as="sourcePoint" />
            <mxPoint x="800" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-roles-hierarchy-label" value="Assign Roles &amp; Permissions" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;fontStyle=1;fontColor=#1a1a1a;" vertex="1" connectable="0" parent="arrow-roles-hierarchy">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- 5 Levels Label -->
        <mxCell id="hierarchy-label" value="5-LEVEL USER HIERARCHY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=20;fontStyle=1;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="550" y="600" width="500" height="50" as="geometry" />
        </mxCell>

        <!-- Level 1: RA Administrator (Detailed) -->
        <mxCell id="level1-admin" value="LEVEL 1: RA ADMINISTRATOR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=16;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="700" width="1360" height="280" as="geometry" />
        </mxCell>

        <mxCell id="admin-role-desc" value="Full System Control - IT Security Managers, PKI Administrators" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="725" width="1320" height="25" as="geometry" />
        </mxCell>

        <!-- Admin Functions in Columns -->
        <!-- Column 1: System Config -->
        <mxCell id="admin-col1" value="ðŸ”§ SYSTEM CONFIGURATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="760" width="250" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-col1-items" value="âœ“ CA Integration (SCEP/CMP/REST)&#xa;âœ“ AD/LDAP Configuration&#xa;âœ“ Certificate Templates&#xa;âœ“ Auto-Enrollment Policies&#xa;âœ“ Email/SMS Templates&#xa;âœ“ TLS/CORS Settings&#xa;âœ“ Rate Limiting Config&#xa;âœ“ Session Timeout&#xa;âœ“ MFA Requirements&#xa;âœ“ Backup/Restore" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="785" width="240" height="165" as="geometry" />
        </mxCell>

        <!-- Column 2: User Management -->
        <mxCell id="admin-col2" value="ðŸ‘¤ USER &amp; ROLE MANAGEMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="410" y="760" width="250" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-col2-items" value="âœ“ Create/Edit/Delete Users&#xa;âœ“ Assign/Revoke Roles&#xa;âœ“ Map AD Groups to Roles&#xa;âœ“ Set Certificate Quotas&#xa;âœ“ Manage Maker-Checker&#xa;âœ“ User Activity Monitoring&#xa;âœ“ Lock/Unlock Accounts&#xa;âœ“ Password Policy Config&#xa;âœ“ Session Management&#xa;âœ“ Access Control Lists" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="415" y="785" width="240" height="165" as="geometry" />
        </mxCell>

        <!-- Column 3: Template Management -->
        <mxCell id="admin-col3" value="ðŸ“‹ TEMPLATE MANAGEMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="680" y="760" width="250" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-col3-items" value="âœ“ Create Templates&#xa;âœ“ Edit Template Settings&#xa;âœ“ Delete Templates&#xa;âœ“ Set Key Algorithms&#xa;âœ“ Define Key Usage&#xa;âœ“ Set Validity Periods&#xa;âœ“ Configure Extensions&#xa;âœ“ Enable Auto-Enrollment&#xa;âœ“ Set Auto-Approval Rules&#xa;âœ“ Template Permissions" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="685" y="785" width="240" height="165" as="geometry" />
        </mxCell>

        <!-- Column 4: Monitoring -->
        <mxCell id="admin-col4" value="ðŸ“Š MONITORING &amp; AUDIT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="950" y="760" width="250" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-col4-items" value="âœ“ System Health Dashboard&#xa;âœ“ CA Connection Status&#xa;âœ“ Database Monitoring&#xa;âœ“ Enrollment Statistics&#xa;âœ“ Complete Audit Logs&#xa;âœ“ Compliance Reports&#xa;âœ“ User Activity Logs&#xa;âœ“ Performance Metrics&#xa;âœ“ Alert Configuration&#xa;âœ“ Log Retention Policy" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="955" y="785" width="240" height="165" as="geometry" />
        </mxCell>

        <!-- Column 5: Auto-Enrollment -->
        <mxCell id="admin-col5" value="âš¡ AUTO-ENROLLMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#b85450;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="1220" y="760" width="250" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-col5-items" value="âœ“ Enable/Disable Globally&#xa;âœ“ Configure Policies&#xa;âœ“ Set Triggers (ON_LOGIN)&#xa;âœ“ Define Eligible Groups&#xa;âœ“ Set Auto-Approval&#xa;âœ“ Configure Renewal&#xa;âœ“ Monitor Jobs&#xa;âœ“ Trigger Bulk Enrollment&#xa;âœ“ View Statistics&#xa;âœ“ Troubleshoot Issues" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="1225" y="785" width="240" height="165" as="geometry" />
        </mxCell>

        <!-- Arrow Level 1 to 2 -->
        <mxCell id="arrow-l1-l2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=12;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="level1-admin" target="level2-officer">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="980" as="sourcePoint" />
            <mxPoint x="800" y="1020" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- Level 2: RA Officer (Detailed) -->
        <mxCell id="level2-officer" value="LEVEL 2: RA OFFICER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=16;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="1020" width="1360" height="280" as="geometry" />
        </mxCell>

        <mxCell id="officer-role-desc" value="Approval &amp; Verification Authority - Security Officers, Certificate Managers (Checker in Maker-Checker)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="1045" width="1320" height="25" as="geometry" />
        </mxCell>

        <!-- Officer Functions -->
        <!-- Column 1: Approval -->
        <mxCell id="officer-col1" value="âœ… CERTIFICATE APPROVAL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="1080" width="330" height="200" as="geometry" />
        </mxCell>

        <mxCell id="officer-col1-items" value="âœ“ Review Pending Requests&#xa;âœ“ Approve Valid Requests&#xa;âœ“ Reject Invalid Requests&#xa;âœ“ Request Additional Info&#xa;âœ“ View Request History&#xa;âœ“ Check Business Justification&#xa;âœ“ Validate CSR Details&#xa;âœ“ Verify AD Profile Match&#xa;âœ“ Check Certificate Quota&#xa;âœ“ Add Approval Comments&#xa;âœ“ Maker-Checker Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="1105" width="320" height="165" as="geometry" />
        </mxCell>

        <!-- Column 2: Revocation -->
        <mxCell id="officer-col2" value="ðŸ”´ CERTIFICATE REVOCATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="490" y="1080" width="300" height="200" as="geometry" />
        </mxCell>

        <mxCell id="officer-col2-items" value="âœ“ Revoke Certificates&#xa;âœ“ Select Revocation Reason:&#xa;  â€¢ Key Compromise&#xa;  â€¢ Cessation of Operation&#xa;  â€¢ Superseded&#xa;  â€¢ Affiliation Changed&#xa;âœ“ Add Revocation Comments&#xa;âœ“ Submit to CA&#xa;âœ“ Update CRL&#xa;âœ“ Notify End Entity&#xa;âœ“ View Revocation History" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="495" y="1105" width="290" height="165" as="geometry" />
        </mxCell>

        <!-- Column 3: Identity Verification -->
        <mxCell id="officer-col3" value="ðŸ” IDENTITY VERIFICATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="810" y="1080" width="300" height="200" as="geometry" />
        </mxCell>

        <mxCell id="officer-col3-items" value="âœ“ In-Person Verification&#xa;âœ“ Check Photo ID:&#xa;  â€¢ Passport&#xa;  â€¢ Driver's License&#xa;  â€¢ Employee ID&#xa;âœ“ Record ID Document Type&#xa;âœ“ Record ID Number&#xa;âœ“ Confirm Face Match&#xa;âœ“ Add Verification Notes&#xa;âœ“ Approve High-Value Certs&#xa;âœ“ Code Signing Certs&#xa;âœ“ Admin Certificates" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="815" y="1105" width="290" height="165" as="geometry" />
        </mxCell>

        <!-- Column 4: Reporting -->
        <mxCell id="officer-col4" value="ðŸ“Š REPORTING &amp; AUDIT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="1130" y="1080" width="340" height="200" as="geometry" />
        </mxCell>

        <mxCell id="officer-col4-items" value="âœ“ View All Operations&#xa;âœ“ Generate Issuance Reports&#xa;âœ“ Generate Revocation Reports&#xa;âœ“ Access Audit Logs&#xa;âœ“ Export Compliance Data&#xa;âœ“ View Statistics&#xa;âœ“ Trigger Auto-Enrollment&#xa;âœ“ Monitor Enrollment Jobs&#xa;&#xa;âš ï¸ CANNOT DO:&#xa;âœ— System Configuration&#xa;âœ— Create Templates" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="1135" y="1105" width="330" height="165" as="geometry" />
        </mxCell>

        <!-- Arrow Level 2 to 3 -->
        <mxCell id="arrow-l2-l3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=12;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="level2-officer" target="level3-operator">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="1300" as="sourcePoint" />
            <mxPoint x="800" y="1340" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-l2-l3-label" value="Approves Submissions From" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1;fontColor=#1a1a1a;" vertex="1" connectable="0" parent="arrow-l2-l3">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Level 3: RA Operator (Detailed) -->
        <mxCell id="level3-operator" value="LEVEL 3: RA OPERATOR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="1340" width="1360" height="280" as="geometry" />
        </mxCell>

        <mxCell id="operator-role-desc" value="Submission &amp; Assistance Authority - Help Desk Staff, Departmental Coordinators (Maker in Maker-Checker)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="1365" width="1320" height="25" as="geometry" />
        </mxCell>

        <!-- Operator Functions -->
        <mxCell id="operator-col1" value="ðŸ“ CSR SUBMISSION (MAKER)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="1400" width="320" height="200" as="geometry" />
        </mxCell>

        <mxCell id="operator-col1-items" value="âœ“ Submit on Behalf of Users&#xa;âœ“ Upload PKCS#10 CSR&#xa;âœ“ Fill Request Forms&#xa;âœ“ Select Templates&#xa;âœ“ Provide Justification&#xa;âœ“ Upload Documents&#xa;âœ“ Submit for Approval&#xa;âœ“ Track Submissions&#xa;âœ“ View Own Requests&#xa;âœ“ Maker-Checker (Maker)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="1425" width="310" height="165" as="geometry" />
        </mxCell>

        <mxCell id="operator-col2" value="ðŸ“Ž DOCUMENT MANAGEMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="480" y="1400" width="300" height="200" as="geometry" />
        </mxCell>

        <mxCell id="operator-col2-items" value="âœ“ Upload Supporting Docs&#xa;âœ“ Attach Identity Proofs&#xa;âœ“ Upload Authorization&#xa;âœ“ Manage Attachments&#xa;âœ“ Update Pre-Approval&#xa;âœ“ Add Missing Info&#xa;âœ“ Correct Errors&#xa;âœ“ Cancel Drafts&#xa;âœ“ Download Issued Certs&#xa;âœ“ Deliver to End Entities" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="485" y="1425" width="290" height="165" as="geometry" />
        </mxCell>

        <mxCell id="operator-col3" value="ðŸ“¥ CERTIFICATE DELIVERY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="800" y="1400" width="300" height="200" as="geometry" />
        </mxCell>

        <mxCell id="operator-col3-items" value="âœ“ Download Certificates&#xa;âœ“ Download Chains&#xa;âœ“ Export Formats:&#xa;  â€¢ PEM (Certificate)&#xa;  â€¢ DER (Binary)&#xa;  â€¢ PKCS#12 (Cert+Key)&#xa;  â€¢ Certificate Chain&#xa;âœ“ Deliver to End Users&#xa;âœ“ Installation Help&#xa;âœ“ Troubleshooting" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="805" y="1425" width="290" height="165" as="geometry" />
        </mxCell>

        <mxCell id="operator-col4" value="âš ï¸ RESTRICTIONS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="1120" y="1400" width="350" height="200" as="geometry" />
        </mxCell>

        <mxCell id="operator-col4-items" value="âœ— CANNOT Approve/Reject&#xa;  (Needs RA Officer)&#xa;&#xa;âœ— CANNOT Revoke Certificates&#xa;  (Officer only)&#xa;&#xa;âœ— CANNOT View All Requests&#xa;  (Only own submissions)&#xa;&#xa;âœ— CANNOT Access Audit Logs&#xa;  (Officer/Admin/Auditor only)&#xa;&#xa;âœ— CANNOT Modify Settings" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;fontColor=#d32f2f;" vertex="1" parent="1">
          <mxGeometry x="1125" y="1425" width="340" height="165" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <!-- Second Page: Level 4 & 5 -->
  <diagram name="Level 4-5 Details" id="level-4-5-details">
    <mxGraphModel dx="1800" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title Page 2 -->
        <mxCell id="page2-title" value="RA User Hierarchy - Level 4 &amp; 5 (Continued)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="200" y="40" width="1200" height="50" as="geometry" />
        </mxCell>

        <!-- Level 4: Auditor (Detailed) -->
        <mxCell id="level4-auditor" value="LEVEL 4: AUDITOR" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=16;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="140" width="1360" height="280" as="geometry" />
        </mxCell>

        <mxCell id="auditor-role-desc" value="Read-Only Compliance Authority - Compliance Officers, Internal Auditors (NO Modifications Allowed)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="165" width="1320" height="25" as="geometry" />
        </mxCell>

        <!-- Auditor Functions -->
        <mxCell id="auditor-col1" value="ðŸ‘ï¸ VIEW ALL OPERATIONS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#9673a6;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="200" width="320" height="200" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col1-items" value="âœ“ View All Cert Requests&#xa;âœ“ View All Issued Certs&#xa;âœ“ View Revocation Records&#xa;âœ“ View Approval History&#xa;âœ“ View Rejection History&#xa;âœ“ View All User Activities&#xa;âœ“ Search &amp; Filter&#xa;âœ“ Advanced Queries&#xa;âœ“ Cross-Reference Data&#xa;âœ“ Timeline Views" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="225" width="310" height="165" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col2" value="ðŸ“œ AUDIT LOG ACCESS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#9673a6;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="480" y="200" width="320" height="200" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col2-items" value="âœ“ Complete Audit Trail&#xa;âœ“ Search by User/Date/Action&#xa;âœ“ Authentication Logs&#xa;âœ“ Failed Login Attempts&#xa;âœ“ Certificate Lifecycle&#xa;âœ“ System Changes&#xa;âœ“ Configuration Changes&#xa;âœ“ Policy Violations&#xa;âœ“ Export Audit Data&#xa;âœ“ Tamper-Proof Storage" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="485" y="225" width="310" height="165" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col3" value="ðŸ“Š COMPLIANCE REPORTING" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#9673a6;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="820" y="200" width="320" height="200" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col3-items" value="âœ“ Generate Reports&#xa;âœ“ Export Data (CSV/JSON/PDF)&#xa;âœ“ Custom Reports&#xa;âœ“ Schedule Automated Reports&#xa;âœ“ Analyze Trends&#xa;âœ“ Identify Patterns&#xa;âœ“ Anomaly Detection&#xa;âœ“ Compliance Dashboards&#xa;âœ“ Statistical Analysis&#xa;âœ“ Executive Summaries" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="825" y="225" width="310" height="165" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col4" value="âš ï¸ STRICT READ-ONLY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#9673a6;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="1160" y="200" width="310" height="200" as="geometry" />
        </mxCell>

        <mxCell id="auditor-col4-items" value="âœ— CANNOT Submit Requests&#xa;âœ— CANNOT Approve/Reject&#xa;âœ— CANNOT Revoke Certs&#xa;âœ— CANNOT Modify Records&#xa;âœ— CANNOT Delete Audit Logs&#xa;âœ— CANNOT Change Config&#xa;âœ— CANNOT Create Users&#xa;âœ— CANNOT Assign Roles&#xa;&#xa;STRICTLY READ-ONLY&#xa;COMPLIANCE &amp; AUDIT ONLY" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;fontColor=#d32f2f;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1165" y="225" width="300" height="165" as="geometry" />
        </mxCell>

        <!-- Arrow Level 4 to 5 -->
        <mxCell id="arrow-l4-l5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=12;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="level4-auditor" target="level5-entity">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="800" y="420" as="sourcePoint" />
            <mxPoint x="800" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-l4-l5-label" value="Monitors Activities Of" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1;fontColor=#1a1a1a;" vertex="1" connectable="0" parent="arrow-l4-l5">
          <mxGeometry x="-0.1" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Level 5: End Entity (Detailed) -->
        <mxCell id="level5-entity" value="LEVEL 5: END ENTITY (SELF-SERVICE)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="480" width="1360" height="420" as="geometry" />
        </mxCell>

        <mxCell id="entity-role-desc" value="Self-Service Users - All Authenticated Employees/End Users (Own Certificates Only)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="505" width="1320" height="25" as="geometry" />
        </mxCell>

        <!-- Row 1 of End Entity Functions -->
        <mxCell id="entity-row1-col1" value="ðŸ“ CERTIFICATE REQUEST" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="540" width="300" height="170" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col1-items" value="âœ“ Submit Own CSR&#xa;âœ“ Upload PKCS#10 CSR&#xa;âœ“ Generate Key Pair:&#xa;  â€¢ Client-side (browser)&#xa;  â€¢ Server-side (RA)&#xa;âœ“ Select Templates&#xa;âœ“ Provide Justification&#xa;âœ“ Track Status&#xa;âœ“ View History" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="565" width="290" height="135" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col2" value="ðŸ” IDENTITY VERIFICATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="460" y="540" width="300" height="170" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col2-items" value="âœ“ Email Verification:&#xa;  â€¢ 24-hour link validity&#xa;  â€¢ Click to verify&#xa;âœ“ Phone/SMS Verification:&#xa;  â€¢ 6-digit OTP&#xa;  â€¢ 5-minute expiry&#xa;  â€¢ 3 attempts max&#xa;âœ“ MFA (if required)&#xa;âœ“ Subject DN Auto-Check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="465" y="565" width="290" height="135" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col3" value="ðŸ‘ï¸ VIEW &amp; MANAGE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="780" y="540" width="300" height="170" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col3-items" value="âœ“ View Own Requests&#xa;âœ“ View Own Certificates&#xa;âœ“ Check Validity&#xa;âœ“ View Expiration Dates&#xa;âœ“ View Details:&#xa;  â€¢ Serial Number&#xa;  â€¢ Subject DN&#xa;  â€¢ Validity Period&#xa;  â€¢ Status&#xa;âœ“ Cancel Pending" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="785" y="565" width="290" height="135" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col4" value="ðŸ“¥ DOWNLOAD CERTIFICATES" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="1100" y="540" width="370" height="170" as="geometry" />
        </mxCell>

        <mxCell id="entity-row1-col4-items" value="âœ“ Download Issued Certs&#xa;âœ“ Download Private Keys&#xa;  (if server-generated)&#xa;âœ“ Formats:&#xa;  â€¢ PEM (Certificate Only)&#xa;  â€¢ DER (Binary Format)&#xa;  â€¢ PKCS#12 (Cert + Key)&#xa;  â€¢ Certificate Chain&#xa;âœ“ Multiple Downloads OK&#xa;âœ“ Installation Guides" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="1105" y="565" width="360" height="135" as="geometry" />
        </mxCell>

        <!-- Row 2 of End Entity Functions -->
        <mxCell id="entity-row2-col1" value="ðŸ”„ CERTIFICATE RENEWAL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="140" y="730" width="350" height="150" as="geometry" />
        </mxCell>

        <mxCell id="entity-row2-col1-items" value="âœ“ Renew Expiring Certs&#xa;âœ“ Alerts (30/15/7 days)&#xa;âœ“ Generate New Key Pair&#xa;âœ“ Submit Renewal Request&#xa;âœ“ Track Renewal Status&#xa;âœ“ Auto-Renewal (if configured)&#xa;âœ“ Grace Period Support&#xa;âœ“ Old Cert Valid During Renewal" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="145" y="755" width="340" height="115" as="geometry" />
        </mxCell>

        <mxCell id="entity-row2-col2" value="ðŸ”” NOTIFICATIONS &amp; ALERTS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="510" y="730" width="350" height="150" as="geometry" />
        </mxCell>

        <mxCell id="entity-row2-col2-items" value="âœ“ Certificate Issued Notices&#xa;âœ“ Expiration Warnings:&#xa;  â€¢ 30 days before&#xa;  â€¢ 15 days before&#xa;  â€¢ 7 days before&#xa;âœ“ Renewal Reminders&#xa;âœ“ Request Status Updates&#xa;âœ“ Email &amp; In-App Notifications&#xa;âœ“ Notification History" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="515" y="755" width="340" height="115" as="geometry" />
        </mxCell>

        <mxCell id="entity-row2-col3" value="âš¡ AUTO-ENROLLMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=left;strokeWidth=1.5;" vertex="1" parent="1">
          <mxGeometry x="880" y="730" width="590" height="150" as="geometry" />
        </mxCell>

        <mxCell id="entity-row2-col3-items" value="âœ“ Automatic Certificate Issuance (if eligible based on AD groups)&#xa;âœ“ Automatic Renewal (if configured in policy)&#xa;âœ“ Receive Auto-Enrolled Certificates&#xa;âœ“ Download Auto-Issued Certificates&#xa;âœ“ NO MANUAL ACTION REQUIRED&#xa;âœ“ Triggered on: LOGIN, SCHEDULED, GROUP_MEMBERSHIP&#xa;âœ“ Background Processing&#xa;âœ“ Email Notification When Ready&#xa;âœ“ Seamless User Experience" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="885" y="755" width="580" height="115" as="geometry" />
        </mxCell>

        <!-- Dashboard Section -->
        <mxCell id="entity-dashboard-box" value="ðŸ“Š END ENTITY DASHBOARD" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3d9ff;strokeColor=#6c8ebf;fontSize=13;fontStyle=1;verticalAlign=top;align=center;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="140" y="1000" width="680" height="220" as="geometry" />
        </mxCell>

        <mxCell id="entity-dashboard-items" value="Welcome, John Doe&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#xa;&#xa;ðŸ“ˆ Summary:&#xa;  â€¢ Active Certificates: 3&#xa;  â€¢ Pending Requests: 1&#xa;  â€¢ Expiring Soon (30 days): 1&#xa;  â€¢ Recent Activity: Certificate issued (2 hours ago)&#xa;&#xa;ðŸ“œ My Certificates (Recent 5):&#xa;  1. Email Certificate - Valid until Jan 16, 2027 âœ“&#xa;  2. VPN Certificate - Valid until Mar 15, 2026 âœ“&#xa;  3. Code Signing - Expiring in 25 days âš &#xa;&#xa;ðŸ“‹ My Requests (Recent 5):&#xa;  1. REQ-12345 - Email Cert - Issued (2 hrs ago) âœ“&#xa;  2. REQ-12344 - VPN Cert - Pending Approval â³&#xa;&#xa;[View All Certificates]  [Request New Certificate]  [Profile]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=15;fontFamily=Courier New;" vertex="1" parent="1">
          <mxGeometry x="150" y="1030" width="660" height="180" as="geometry" />
        </mxCell>

        <!-- Restrictions Section -->
        <mxCell id="entity-restrictions-box" value="âš ï¸ END ENTITY RESTRICTIONS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#b85450;fontSize=13;fontStyle=1;verticalAlign=top;align=center;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="840" y="1000" width="630" height="220" as="geometry" />
        </mxCell>

        <mxCell id="entity-restrictions-items" value="âœ— CANNOT Submit Requests for Others&#xa;  (Only own certificate requests)&#xa;&#xa;âœ— CANNOT View Others' Certificates&#xa;  (Privacy &amp; security - own certificates only)&#xa;&#xa;âœ— CANNOT Approve/Reject Requests&#xa;  (Requires RA Officer role)&#xa;&#xa;âœ— CANNOT Revoke Certificates&#xa;  (Must contact RA Officer for revocation)&#xa;&#xa;âœ— CANNOT Access Audit Logs&#xa;  (Restricted to Auditor/Officer/Admin)&#xa;&#xa;âœ— CANNOT View System Configuration&#xa;  (Restricted to RA Administrator)&#xa;&#xa;SELF-SERVICE ONLY - OWN CERTIFICATES" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;spacingLeft=15;fontColor=#d32f2f;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="850" y="1030" width="610" height="180" as="geometry" />
        </mxCell>

        <!-- Summary Box at Bottom -->
        <mxCell id="summary-box" value="SUMMARY: 5-LEVEL HIERARCHY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=15;fontStyle=1;verticalAlign=top;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="120" y="1280" width="1360" height="180" as="geometry" />
        </mxCell>

        <mxCell id="summary-content" value="Level 1: RA ADMINISTRATOR â†’ Full Control (System, Users, Templates, Policies, Audit)&#xa;Level 2: RA OFFICER â†’ Approval Authority (Approve/Reject CSR, Revoke Certs, Identity Verification, Reporting)&#xa;Level 3: RA OPERATOR â†’ Submission Authority (Submit CSR, Upload Docs, Deliver Certs) - MAKER in Maker-Checker&#xa;Level 4: AUDITOR â†’ Read-Only (View All, Audit Logs, Compliance Reports, NO Modifications)&#xa;Level 5: END ENTITY â†’ Self-Service (Own Certs Only, Auto-Enrollment, Renewal, Download)&#xa;&#xa;Key Features:&#xa;âœ“ Maker-Checker Workflow (Operator submits â†’ Officer approves)&#xa;âœ“ Multi-Layer Identity Verification (Email, SMS/OTP, In-Person, Subject DN)&#xa;âœ“ Auto-Enrollment (ON_LOGIN trigger, AD group-based, automatic approval)&#xa;âœ“ Automatic Renewal (30-day threshold, grace period, auto-revoke old cert)&#xa;âœ“ Complete Audit Trail (All actions logged, tamper-proof, compliance reporting)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=20;" vertex="1" parent="1">
          <mxGeometry x="140" y="1310" width="1320" height="140" as="geometry" />
        </mxCell>

        <!-- Footer -->
        <mxCell id="footer-p2" value="Registration Authority (RA) - Complete User Hierarchy | Version 2.0 | 2026-01-16 | Page 2 of 2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="200" y="1500" width="1200" height="30" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
