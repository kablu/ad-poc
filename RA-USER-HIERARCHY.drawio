<mxfile host="app.diagrams.net" modified="2026-01-16T00:00:00.000Z" agent="Claude Code" version="24.0.0">
  <diagram name="RA User Hierarchy" id="ra-user-hierarchy">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="1654" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Registration Authority (RA) - User Hierarchy" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="280" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- Active Directory Layer -->
        <mxCell id="ad-box" value="Active Directory (AD)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="200" y="80" width="760" height="100" as="geometry" />
        </mxCell>

        <mxCell id="ad-details" value="LDAP/LDAPS Authentication&#xa;ldap://ad.company.com:389&#xa;Base DN: dc=company,dc=com" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="240" y="110" width="680" height="60" as="geometry" />
        </mxCell>

        <!-- Arrow from AD to Mapping -->
        <mxCell id="arrow-ad-mapping" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=12;" edge="1" parent="1" source="ad-box" target="mapping-box">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="180" as="sourcePoint" />
            <mxPoint x="580" y="220" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-ad-mapping-label" value="Authentication &amp; Group Membership" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" vertex="1" connectable="0" parent="arrow-ad-mapping">
          <mxGeometry x="-0.2" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Role Mapping Layer -->
        <mxCell id="mapping-box" value="RA Web Application - Role Mapping" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=16;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="200" y="220" width="760" height="180" as="geometry" />
        </mxCell>

        <!-- Mapping Table -->
        <mxCell id="mapping-header" value="AD Group → Application Role" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="240" y="250" width="680" height="25" as="geometry" />
        </mxCell>

        <mxCell id="map1" value="&quot;PKI-RA-Admins&quot; → RA Administrator" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="285" width="300" height="20" as="geometry" />
        </mxCell>

        <mxCell id="map2" value="&quot;PKI-RA-Officers&quot; → RA Officer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="310" width="300" height="20" as="geometry" />
        </mxCell>

        <mxCell id="map3" value="&quot;PKI-RA-Operators&quot; → RA Operator" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="335" width="300" height="20" as="geometry" />
        </mxCell>

        <mxCell id="map4" value="&quot;PKI-Auditors&quot; → Auditor" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="360" width="300" height="20" as="geometry" />
        </mxCell>

        <mxCell id="map5" value="&quot;Domain Users&quot; → End Entity (default)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="385" width="300" height="20" as="geometry" />
        </mxCell>

        <!-- Arrow from Mapping to Roles -->
        <mxCell id="arrow-mapping-roles" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=12;" edge="1" parent="1" source="mapping-box" target="roles-label">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="400" as="sourcePoint" />
            <mxPoint x="580" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-mapping-roles-label" value="Role Assignment" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" vertex="1" connectable="0" parent="arrow-mapping-roles">
          <mxGeometry x="-0.2" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- 5 User Roles Label -->
        <mxCell id="roles-label" value="5 User Roles in RA Application" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="390" y="450" width="380" height="40" as="geometry" />
        </mxCell>

        <!-- Level 1: RA Administrator -->
        <mxCell id="admin-box" value="RA Administrator" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="80" y="540" width="280" height="200" as="geometry" />
        </mxCell>

        <mxCell id="admin-subtitle" value="Level 1: Full Control" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="90" y="565" width="260" height="20" as="geometry" />
        </mxCell>

        <mxCell id="admin-perms" value="✓ System Configuration&#xa;✓ User &amp; Role Management&#xa;✓ Template Management&#xa;✓ Policy Settings&#xa;✓ Audit Logs&#xa;✓ Auto-Enrollment Config&#xa;✓ All Certificate Operations" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="100" y="590" width="240" height="140" as="geometry" />
        </mxCell>

        <!-- Level 2: RA Officer -->
        <mxCell id="officer-box" value="RA Officer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=14;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="390" y="540" width="280" height="200" as="geometry" />
        </mxCell>

        <mxCell id="officer-subtitle" value="Level 2: Approval Power" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="400" y="565" width="260" height="20" as="geometry" />
        </mxCell>

        <mxCell id="officer-perms" value="✓ Approve/Reject CSR&#xa;✓ Revoke Certificates&#xa;✓ View All Requests&#xa;✓ Generate Reports&#xa;✓ Identity Verification&#xa;✓ Trigger Auto-Enrollment&#xa;✗ System Configuration&#xa;✗ User Management" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="410" y="590" width="240" height="140" as="geometry" />
        </mxCell>

        <!-- Level 3: RA Operator -->
        <mxCell id="operator-box" value="RA Operator" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="700" y="540" width="280" height="200" as="geometry" />
        </mxCell>

        <mxCell id="operator-subtitle" value="Level 3: Submission Authority" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="710" y="565" width="260" height="20" as="geometry" />
        </mxCell>

        <mxCell id="operator-perms" value="✓ Submit CSR for Users&#xa;✓ Upload Documents&#xa;✓ View Own Submissions&#xa;✓ Download Certificates&#xa;✓ Update Pre-Approval&#xa;✗ Approve/Reject&#xa;✗ Revoke Certificates&#xa;✗ View All Requests" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="720" y="590" width="240" height="140" as="geometry" />
        </mxCell>

        <!-- Level 4: Auditor -->
        <mxCell id="auditor-box" value="Auditor" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="235" y="780" width="280" height="200" as="geometry" />
        </mxCell>

        <mxCell id="auditor-subtitle" value="Level 4: Read-Only" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="245" y="805" width="260" height="20" as="geometry" />
        </mxCell>

        <mxCell id="auditor-perms" value="✓ View All Operations&#xa;✓ Access Audit Logs&#xa;✓ Generate Reports&#xa;✓ Export Compliance Data&#xa;✓ Analyze Trends&#xa;✗ NO Modifications&#xa;✗ NO Certificate Operations&#xa;✗ NO System Changes" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="255" y="830" width="240" height="140" as="geometry" />
        </mxCell>

        <!-- Level 5: End Entity -->
        <mxCell id="entity-box" value="End Entity" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="545" y="780" width="280" height="200" as="geometry" />
        </mxCell>

        <mxCell id="entity-subtitle" value="Level 5: Self-Service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="555" y="805" width="260" height="20" as="geometry" />
        </mxCell>

        <mxCell id="entity-perms" value="✓ Submit Own CSR&#xa;✓ View Own Status&#xa;✓ Download Own Certificates&#xa;✓ Renew Own Certificates&#xa;✓ Auto-Enrollment (Receive)&#xa;✗ Submit for Others&#xa;✗ View Others' Data&#xa;✗ Approve/Revoke" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="565" y="830" width="240" height="140" as="geometry" />
        </mxCell>

        <!-- Arrows connecting roles -->
        <mxCell id="arrow-roles-admin" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;" edge="1" parent="1" source="roles-label" target="admin-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow-roles-officer" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;" edge="1" parent="1" source="roles-label" target="officer-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow-roles-operator" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;" edge="1" parent="1" source="roles-label" target="operator-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow-admin-auditor" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;dashed=1;" edge="1" parent="1" source="admin-box" target="auditor-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow-officer-auditor" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;dashed=1;" edge="1" parent="1" source="officer-box" target="auditor-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow-operator-entity" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;dashed=1;" edge="1" parent="1" source="operator-box" target="entity-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="Legend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;fontStyle=1;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="80" y="1020" width="900" height="80" as="geometry" />
        </mxCell>

        <mxCell id="legend-solid" value="" style="endArrow=classic;html=1;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="1050" as="sourcePoint" />
            <mxPoint x="180" y="1050" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="legend-solid-text" value="Direct Role Assignment" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="190" y="1040" width="140" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-dashed" value="" style="endArrow=classic;html=1;strokeWidth=1;dashed=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="1075" as="sourcePoint" />
            <mxPoint x="180" y="1075" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="legend-dashed-text" value="Hierarchy Flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="190" y="1065" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-admin" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="360" y="1045" width="30" height="15" as="geometry" />
        </mxCell>

        <mxCell id="legend-admin-text" value="Administrator" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="395" y="1040" width="80" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-officer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="360" y="1070" width="30" height="15" as="geometry" />
        </mxCell>

        <mxCell id="legend-officer-text" value="Officer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="395" y="1065" width="80" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-operator" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="500" y="1045" width="30" height="15" as="geometry" />
        </mxCell>

        <mxCell id="legend-operator-text" value="Operator" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="535" y="1040" width="80" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-auditor" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="500" y="1070" width="30" height="15" as="geometry" />
        </mxCell>

        <mxCell id="legend-auditor-text" value="Auditor" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="535" y="1065" width="80" height="20" as="geometry" />
        </mxCell>

        <mxCell id="legend-entity" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="640" y="1045" width="30" height="15" as="geometry" />
        </mxCell>

        <mxCell id="legend-entity-text" value="End Entity" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="675" y="1040" width="80" height="20" as="geometry" />
        </mxCell>

        <!-- Footer -->
        <mxCell id="footer" value="RA Web Application - User Hierarchy | Version 1.0 | 2026-01-16" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="280" y="1130" width="600" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
